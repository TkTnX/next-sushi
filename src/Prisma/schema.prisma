generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider  = "postgresql"
    url       = env("POSTGRES_PRISMA_URL") // uses connection pooling
    directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

model Category {
    id       Int    @id @default(autoincrement())
    name     String
    imageUrl String

    products Product[]

    createdAt DateTime @default(now())
    updatedAt DateTime @default(now())
}

model Product {
    id          Int    @id @default(autoincrement())
    name        String
    description String
    price       Int
    weight      Int
    imageUrl    String

    type   Type @relation(fields: [typeId], references: [id])
    typeId Int

    exceptions ProductsOnExceptions[]

    ingredients Ingredient[]

    category   Category @relation(fields: [categoryId], references: [id])
    categoryId Int
    createdAt  DateTime @default(now())
    updatedAt  DateTime @default(now())
}

model Type {
    id Int @id @default(autoincrement())

    name     String
    products Product[]

    createdAt DateTime @default(now())
    updatedAt DateTime @default(now())
}

model Exception {
    id Int @id @default(autoincrement())

    imageUrl String
    name     String

 

    createdAt DateTime @default(now())
    updatedAt DateTime @default(now())

    products ProductsOnExceptions[]
}

model Ingredient {
    id Int @id @default(autoincrement())

    name     String
    imageUrl String

    products Product[]

    createdAt DateTime @default(now())
    updatedAt DateTime @default(now())
}

model ProductsOnExceptions {
    product   Product @relation(fields: [productId], references: [id])
    productId Int

    exception Exception @relation(fields: [exceptionId], references: [id])
    exceptionId Int

    @@id([productId, exceptionId])
}